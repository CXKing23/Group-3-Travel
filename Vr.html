<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Adventure</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap">
    <style>
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background-color: #000;
            color: #fff;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            font-size: 18px;
        }

        header {
            background-color: #000;
            padding: 10px 0;
            text-align: center;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            transition: background-color 0.3s ease;
        }

        section {
            padding: 20px;
            margin-top: 60px;
            width: 100%;
            background-color: #000;
            flex: 1;
        }

        footer {
            background-color: #222;
            padding: 10px 0;
            text-align: center;
        }

        header.sticky {
            background-color: #222;
        }

        h1, h2 {
            color: #fff;
        }

        p {
            color: #aaa;
        }

        a {
            color: #6EC6D9;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover {
            color: #6EC6D9;
        }

        .about-image {
            width: 100%; 
            max-width: 700px; 
            height: auto;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        #visa-info {
            display: none;
            margin-top: 20px;
        }

        #no-info {
            display: none;
            color: red;
            margin-top: 20px;
        }

        #loading {
            display: none;
            text-align: center;
        }

        .spinner {
            border: 4px solid #f3f3f3; 
            border-top: 4px solid #3498db; 
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html">Travel Adventure</a>
    </header>

    <section>
        <h1>Let's find out what you need</h1>
        <h2>Your Journey</h2>

        <div class="form-container">
            <div>
                <label for="from">From:</label>
                <select id="from">
                    <option value="US">United States</option>
                    <option value="CA">Canada</option>
                    <option value="BB">Barbados</option>
                    <option value="DZ">Algeria</option>
                    <option value="AR">Argentina</option>
                    <option value="AT">Austria</option>
                    <option value="BS">Bahamas</option>
                    <option value="NE">Niger</option>
                </select>
            </div>

            <div>
                <label for="to">To:</label>
                <select id="to">
                    <option value="BB">Barbados</option>
                    <option value="CA">Canada</option>
                    <option value="BS">Bahamas</option>
                    <option value="DZ">Algeria</option>
                    <option value="AR">Argentina</option>
                    <option value="AT">Austria</option>
                    <option value="US">United States</option>
                    <option value="NE">Niger</option>
                </select>
            </div>
        </div>

        <button onclick="getVisaRequirements()">Get Visa Requirements</button>

        <div id="loading">
            <div class="spinner"></div>
            <p>Loading...</p>
        </div>

        <div id="visa-info">
            <h3>Visa Information:</h3>
            <p><strong>Visa Type:</strong> <span id="visa-type"></span></p>
            <p><strong>Stay Duration:</strong> <span id="stay-duration"></span></p>
            <p><strong>Required Documents:</strong></p>
            <ul id="visa-docs"></ul>
        </div>

       
    </section>

    <footer>
        <p>&copy; 2025 Travel Adventure | <a href="#">Contact Us</a></p>
    </footer>

    <script>
        window.onload = async () => {
            try {
                const res = await fetch('https://ipapi.co/json/');
                const data = await res.json();
                console.log("Detected IP data: ", data); 
                const countryCode = data.country_code;

                const fromDropdown = document.getElementById('from');
                for (let option of fromDropdown.options) {
                    if (option.value === countryCode) {
                        fromDropdown.value = countryCode;
                        break;
                    }
                }
            } catch (err) {
                console.log("IP detection failed:", err);
            }
        };

        async function getVisaRequirements() {
            const from = document.getElementById('from').value;
            const to = document.getElementById('to').value;

            console.log("Fetching visa requirements for:", from, "to", to); 

            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('visa-info').style.display = 'none';
            document.getElementById('no-info').style.display = 'none';

            try {
                
                const response = await fetch(`https://rough-sun-2523.fly.dev/visa/${from}/${to}`);
                const data = await response.json();
                console.log("API Response:", data); 

         
                document.getElementById('loading').style.display = 'none';

                if (data.category) {
                    document.getElementById('visa-info').style.display = 'block';
                    document.getElementById('no-info').style.display = 'none';

                    document.getElementById('visa-type').textContent = data.category.replace('-', ' ');
                    document.getElementById('stay-duration').textContent = `${data.dur} days`;

                  
                    const docsList = document.getElementById('visa-docs');
                    docsList.innerHTML = '';
                    const commonDocs = [
                        "Passport (valid for at least 6 months)",
                        "Return ticket",
                        "Hotel booking or proof of accommodation"
                    ];
                    commonDocs.forEach(doc => {
                        const li = document.createElement('li');
                        li.textContent = doc;
                        docsList.appendChild(li);
                    });
                } else {
                    throw new Error("No data available");
                }
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('visa-info').style.display = 'none';
                document.getElementById('no-info').style.display = 'block';
                console.error("Error fetching visa info:", error);
            }
        }
    </script>
</body>
</html>
